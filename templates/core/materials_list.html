{% extends 'base.html' %}
{% load static %}

{% block title %}–£—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/materials.css' %}">
{% endblock %}

{% block content %}
<div class="page-wrapper">
  <div class="tasks-page">
    <header class="tasks-header">
      <h1 class="tasks-title">üìö –£—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</h1>
      <p style="color: #94a3b8; margin: 0.5rem 0 0; font-size: 1.05rem;">–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏</p>
    </header>
    
    {% if not tags and not untagged_materials %}
      <div class="empty-state" style="text-align: center; color: #94a3b8; padding: 2rem;">
        <p>–ú–∞—Ç–µ—Ä–∏–∞–ª—ã –µ—â–µ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã. –ó–∞–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω–∫—É.</p>
      </div>
    {% else %}
      
      <!-- –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –ø–æ —Ç–µ–º–∞–º -->
      {% for tag in tags %}
        <div class="algorithm-section">
          <h2 class="algorithm-title">{{ tag.name }}</h2>
          <div class="tasks-grid">
            {% for material in tag.materials.all %}
            <a href="{% url 'material_detail' material.slug %}" class="task-card">
              <div class="task-badge" style="background: rgba(59, 130, 246, 0.2); color: #60a5fa;">
                –¢–µ–æ—Ä–∏—è #{{ material.order }}
              </div>
              <div class="task-card-title">{{ material.title }}</div>
              <div class="task-card-desc">–û–±–Ω–æ–≤–ª–µ–Ω–æ {{ material.updated_at|date:"d.m.Y" }}</div>
            </a>
            {% endfor %}
          </div>
        </div>
      {% endfor %}

      <!-- –û–±—â–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã (–±–µ–∑ —Ç–µ–≥–æ–≤) -->
      {% if untagged_materials %}
        <div class="algorithm-section">
          <h2 class="algorithm-title">üìÇ –û–±—â–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</h2>
          <div class="tasks-grid">
            {% for material in untagged_materials %}
            <a href="{% url 'material_detail' material.slug %}" class="task-card">
              <div class="task-badge" style="background: rgba(148, 163, 184, 0.2); color: #cbd5e1;">
                –¢–µ–æ—Ä–∏—è #{{ material.order }}
              </div>
              <div class="task-card-title">{{ material.title }}</div>
              <div class="task-card-desc">–û–±–Ω–æ–≤–ª–µ–Ω–æ {{ material.updated_at|date:"d.m.Y" }}</div>
            </a>
            {% endfor %}
          </div>
        </div>
      {% endif %}

    {% endif %}
  </div>
</div>
{% endblock %}
