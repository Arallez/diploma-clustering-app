{% extends 'base.html' %}
{% load static %}

{% block title %}–ó–∞–¥–∞–Ω–∏—è{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/tasks.css' %}?v=1.4">
<style>
    .task-card.completed {
        border-color: #059669;
        background: #022c22;
        position: relative;
    }
    .task-card.completed::after {
        content: "‚úÖ";
        position: absolute;
        top: 10px;
        right: 10px;
        font-size: 1.2rem;
    }
    .task-card.completed:hover {
        border-color: #10b981;
    }
</style>
{% endblock %}

{% block content %}
<div class="page-wrapper">
  <div class="tasks-page">
    <header class="tasks-header">
      <h1 class="tasks-title">üéØ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è</h1>
    </header>

    {% for tag in tags %}
      <div class="algorithm-section">
        <h2 class="algorithm-title">{{ tag.name }}</h2>
        <div class="tasks-grid">
          {% for task in tag.tasks.all %}
          <a href="{% url 'tasks:challenge_detail' task.slug %}" class="task-card {% if task.id in completed_task_ids %}completed{% endif %}">
            <div class="task-badge difficulty-{{ task.difficulty }}">
              {% if task.difficulty == 1 %}‚≠ê Novice
              {% elif task.difficulty == 2 %}‚≠ê‚≠ê Beginner
              {% else %}‚≠ê‚≠ê‚≠ê Hard
              {% endif %}
            </div>
            <div class="task-card-title">{{ task.title }}</div>
            <div class="task-card-desc">{{ task.description|striptags|truncatewords:15 }}</div>
          </a>
          {% empty %}
            <p style="color: #64748b;">–í —ç—Ç–æ–º –±–ª–æ–∫–µ –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–¥–∞—á.</p>
          {% endfor %}
        </div>
      </div>
    {% endfor %}

    {% if uncategorized %}
    <div class="algorithm-section">
      <h2 class="algorithm-title">üìÇ –†–∞–∑–Ω–æ–µ</h2>
      <div class="tasks-grid">
        {% for task in uncategorized %}
        <a href="{% url 'tasks:challenge_detail' task.slug %}" class="task-card {% if task.id in completed_task_ids %}completed{% endif %}">
          <div class="task-badge difficulty-{{ task.difficulty }}">
            {% if task.difficulty == 1 %}‚≠ê Novice
            {% elif task.difficulty == 2 %}‚≠ê‚≠ê Beginner
            {% else %}‚≠ê‚≠ê‚≠ê Hard
            {% endif %}
          </div>
          <div class="task-card-title">{{ task.title }}</div>
          <div class="task-card-desc">{{ task.description|striptags|truncatewords:15 }}</div>
        </a>
        {% endfor %}
      </div>
    </div>
    {% endif %}

    {% if not tags and not uncategorized %}
      <div class="empty-state" style="text-align: center; color: #94a3b8; padding: 2rem;">
        <p>–ó–∞–¥–∞—á –ø–æ–∫–∞ –Ω–µ—Ç. –î–æ–±–∞–≤—å—Ç–µ —Ç–µ–≥–∏ –∏ –∑–∞–¥–∞—á–∏ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É.</p>
      </div>
    {% endif %}

  </div>
</div>
{% endblock %}
