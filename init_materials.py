from apps.core.models import Material
from django.utils.text import slugify

# K-Means Theory Content (extracted from Voron-ML-Clustering-SSL-slides.pdf)
kmeans_content = """
## Что такое кластеризация?

Кластеризация — это задача обучения без учителя (unsupervised learning). 
Дано множество объектов $X$ и функция расстояния $\\rho(x, x')$. 
Необходимо разбить объекты на множество кластеров $Y$ так, чтобы:
* Каждый кластер состоял из близких объектов.
* Объекты разных кластеров существенно различались.

## Метод K-средних (K-Means)

Это один из самых популярных алгоритмов кластеризации. Он пытается минимизировать суммарное квадратичное отклонение точек кластеров от центров этих кластеров.

### Алгоритм (Ллойда)
Вход: выборка $X$, число кластеров $K$.
Выход: центры кластеров $\\mu_a$.

1. **Инициализация**: Выбрать $K$ случайных точек в качестве начальных центров $\\mu_a$.
2. **Повторять до сходимости**:
    * **Шаг назначения (E-step)**: Относим каждую точку $x_i$ к ближайшему центру:
      $$ a_i = \\arg \\min_{a \\in Y} ||x_i - \\mu_a|| $$
    * **Шаг пересчета (M-step)**: Вычисляем новые положения центров как среднее арифметическое точек, отнесенных к этому кластеру:
      $$ \\mu_a = \\frac{\\sum_{i=1}^{\\ell} [a_i = a] x_i}{\\sum_{i=1}^{\\ell} [a_i = a]} $$
    * Если центры не изменились, алгоритм останавливается.

### Особенности и недостатки
* **Жесткая кластеризация**: Каждая точка принадлежит ровно одному кластеру (в отличие от GMM, где принадлежность вероятностная).
* **Сферические кластеры**: Алгоритм плохо работает с кластерами сложной формы (например, вложенные кольца), так как предполагает, что кластеры — это сферы вокруг центра.
* **Чувствительность к инициализации**: Результат сильно зависит от того, куда упали начальные центры. (Рекомендуется использовать k-means++).
* **Число кластеров**: Необходимо знать $K$ заранее.

### Сравнение с EM-алгоритмом
K-Means можно рассматривать как упрощенный вариант EM-алгоритма для разделения смеси гауссиан (GMM), где:
* Кластеризация "жесткая" ($P(a|x) \\in \{0, 1\}$).
* Матрицы ковариации единичные (сферические кластеры без настройки формы).
"""

# Create the material
Material.objects.get_or_create(
    slug='k-means-theory',
    defaults={
        'title': 'Метод K-средних (K-Means)',
        'content': kmeans_content,
        'order': 1
    }
)

print("Material 'K-Means Theory' created successfully!")
